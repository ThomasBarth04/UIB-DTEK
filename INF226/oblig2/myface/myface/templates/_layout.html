<!DOCTYPE html>
<html lang="en">
    <head>
        {% block head %}
        <title>{% block title %}{% endblock %} – MyFace™</title>
        <link rel="stylesheet" href="{{url_for('static', filename='style.css')}}" />
        <script src="{{url_for('static', filename='script.js')}}" type="module"></script>
        <script src="{{url_for('static', filename='_flashes.js')}}" type="module"></script>
        <link rel="icon" href="{{url_for('static', filename='favicon.png')}}" type="image/png" />
        {% endblock %}
    </head>

    <body>
        <div id="page" class="{{layout or 'layout-plain'}}">
            <header id="page-header">
                <nav id="main-nav"
                    ><ul>
                        <li id="nav-home"><a href="{{url_for('index_html')}}">MyFace™ Home</a></li>
                        <li id="nav-login">
                            {% if current_user.is_authenticated %}<a href="{{url_for('logout')}}"
                                >Log out {{current_user.username}}</a
                            >{% else %}<a href="{{url_for('login', next=request.path)}}">Log in</a>{% endif %}
                        </li>
                    </ul></nav
                >
                <h1 id="nav-mid"
                    >{% if current_user.is_authenticated %}{{current_user.name or current_user.username}}'s&#32;{% endif
                    %}MyFace</h1
                >
            </header>
            {% with messages = get_flashed_messages(with_categories=True) %}
            <div class="flashes-container">
                <!-- ul id="flash-log" class="flashes right"> </ul -->
                <ul
                    id="flashes"
                    class="flashes right"
                    aria-live="polite"
                    aria-relevant="additions"
                    aria-label="Notifications">
                    {% if messages %} {% for category, message in messages %}
                    <li class="flash {{ category }} new">
                        <div class="flash-inner">{{ message }}</div>
                    </li>
                    {% endfor %} {% endif %}
                </ul>
                {% endwith %}
            </div>
            <main id="content">
                <aside class="sidebar"
                    >{% block sidebar %}{% include "_sidebar.html" ignore missing %}{% endblock %}</aside
                >
                {% block content %}<!-- will be replaced with actual content from the individual template -->{% endblock
                %}
            </main>
            <nav class="toc" aria-label="Menu"
                ><h2>Menu</h2
                ><ul>
                    <li><a href="{{url_for('index_html')}}">Home</a></li>
                    {% if current_user.is_authenticated %}
                    <li><a href="{{url_for('profile')}}">Profile</a></li>
                    <li><a href="{{url_for('get_users')}}">Users</a></li>
                    {% else %}
                    <li><a href="{{url_for('login', next=request.path)}}">Log in</a></li>
                    {% endif %}
                </ul>
                <h2>My buddies</h2>
                <ul id="buddies"></ul>
            </nav>
            <footer id="main-footer">
                {% block footer %}
                <ul>
                    {% for name, footer in footers.items() %}
                    <li><a href="{{url_for('info', name=name)}}">{{footer['linktitle']}}</a></li>
                    {% endfor %}
                </ul>
                {% endblock %}
            </footer>
        </div>
    </body>
    {% block script %}{% endblock %}
    <script type="module" nonce="{{g.csp_nonce}}">
        // make JavaScript code available from the console
           import * as MyFace from '{{url_for('static', filename='script.js')}}';
           import * as UHtml from '{{url_for('static', filename='_uhtml.js')}}';
           window.MyFace = MyFace;
           window.UHtml = UHtml
           // keep track of the current user in a global variable (the value is expanded by the template processor)
           window.current_user_id = '{{current_user.id}}';
    </script>
</html>
